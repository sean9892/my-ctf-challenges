# hoshimachi writeup

1. **Prerequisite** - Characteristic polynomial of LFSR, Extended euclidean algorithm
2. **Objective** - find the strength of using characteristic polynomial

## Write-up

For the given 2 LFSR $L_1$ and $L_2$, we want to recover three consecutive output of $L_1$ after the hint generated.

Note that characteristic polynomial $f$ of $L_1$ and char-poly $g$ of $L_2$ are:

$$
f = x^{32} + x^{31} + x^{30} + x^{28} + x^{27} + x^{25} + x^{23} + x^{21} + x^{19} + x^{17} + x^{15} + x^{14} + x^9 + x^7 + x^4 + x + 1\\
g = x^{32} + x^{30} + x^{27} + x^{24} + x^{20} + x^{16} + x^{14} + x^{13} + x^{12} + x^{11} + x^{10} + x^7 + x^5 + x^3 + x^2 + x + 1
$$

The reason we use characteristic **polynomial** to analyze LFSR is that index-shifting can be easily accomplished with multiplying $x$ to the char-poly.

Here, we could consider an ideal $I_f$ which generated by $f$.

For every element $h\in I_f$ there's a polynomial $h^\prime$ such that $h=h^\prime f$. That is, $h$ essentially stands for an equation created by index-shifting and adding the characteristic equation.

Thus, inner-producting $h$ with $L_1$ sequence gives zero. Let's denote an inner-product of polynomial $p$ and LFSR $L$ as $\langle p\vert L \rangle$. Then we get $\langle h\vert L_1 \rangle = 0$.

In this step, we could assume a polynomial $p$ which satisfies $p=p_f f+1=p_g g$.

Note that $\langle p\vert L_1 \rangle = \langle p_f f\vert L_1 \rangle + L_1 = 0+L_1 = L_1$. Also, we get $\langle p\vert L_2 \rangle=\langle p_g g\vert L_2 \rangle=0$.

Here, we can find $\langle p\vert L_1+L_2 \rangle=L_1$.

If degree of $p$ is less than that of $\text{lcm}(f,g)$, it doesn't require to recover full states of $L_1$ and $L_2$.

Then, how can we find $p$ with a minimal degree?

Focus on its definition: $p=p_f f+1=p_g g$.

Since we're dealing over $\mathbb{F}_2$, $1=p-p+1=p_f f + p_g g$ implies that we can find $p_f,p_g$ by extended euclidean algorithm.

After all, $p=p_g g$ is:

$$
p = x^{58} + x^{57} + x^{55} + x^{54} + x^{50} + x^{41} + x^{40} + x^{37} + x^{36} + x^{33} + x^{31} + x^{29} + x^{27} + x^{26} + x^{25} + x^{24} + x^{23} + x^{22} + x^{19} + x^{16} + x^{11} + x^{10} + x^9 + x^8 + x^7 + x^6 + x^4 + x^3
$$

Therefore, using tap `[0, 1, 3, 4, 8, 17, 18, 21, 22, 25, 27, 29, 31, 32, 33, 34, 35, 36, 39, 42, 47, 48, 49, 50, 51, 52, 54, 55]` predicts the output three times earlier, which is what we exactly want.

## Unintended Solution

Since getting the required values is possible, just put everything to z3-solver.